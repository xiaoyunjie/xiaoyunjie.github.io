<!-- build time:Thu Apr 16 2020 20:59:25 GMT+0800 (China Standard Time) --><!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hexo 3.8.0"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1,user-scalable=no,minimal-ui"><meta name="renderer" content="webkit"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta name="format-detection" content="telephone=no,email=no,adress=no"><meta name="theme-color" content="#000000"><meta http-equiv="window-target" content="_top"><title>敏感数据识别和分级打标 | 猪蹄胖的博客</title><meta name="description" content="一、信息安全技术政务信息共享数据安全技术要求数据安全技术要求共享数据提供方在进行数据分级分类时的安全要求包括：应按照政务信息资源分级分类相关要求对共享数据分级分类并进行标记，根据标记可对数据安全等级进行识别，并需要保留标记记录，作为审计依据；应按照数据级别确定所必要的安全防护措施；应对共享数据分级分类的变更进行记录，并通知相关数据使用方；应明确使用方对共享数据的使用权限，包括是否允许数据存储、数"><meta name="keywords" content="python"><meta property="og:type" content="article"><meta property="og:title" content="敏感数据识别和分级打标"><meta property="og:url" content="https://www.browsersytle.cn/2019/11/13/敏感数据识别和分级打标.html"><meta property="og:site_name" content="猪蹄胖的窝"><meta property="og:description" content="一、信息安全技术政务信息共享数据安全技术要求数据安全技术要求共享数据提供方在进行数据分级分类时的安全要求包括：应按照政务信息资源分级分类相关要求对共享数据分级分类并进行标记，根据标记可对数据安全等级进行识别，并需要保留标记记录，作为审计依据；应按照数据级别确定所必要的安全防护措施；应对共享数据分级分类的变更进行记录，并通知相关数据使用方；应明确使用方对共享数据的使用权限，包括是否允许数据存储、数"><meta property="og:locale" content="zh-CN"><meta property="og:image" content="https://www.browsersytle.cn/2019/11/13/%E6%95%8F%E6%84%9F%E6%95%B0%E6%8D%AE%E8%AF%86%E5%88%AB%E5%92%8C%E5%88%86%E7%BA%A7%E6%89%93%E6%A0%87/architecture.jpg"><meta property="og:image" content="https://www.browsersytle.cn/2019/11/13/%E6%95%8F%E6%84%9F%E6%95%B0%E6%8D%AE%E8%AF%86%E5%88%AB%E5%92%8C%E5%88%86%E7%BA%A7%E6%89%93%E6%A0%87/place.jpg"><meta property="og:image" content="https://www.browsersytle.cn/2019/11/13/%E6%95%8F%E6%84%9F%E6%95%B0%E6%8D%AE%E8%AF%86%E5%88%AB%E5%92%8C%E5%88%86%E7%BA%A7%E6%89%93%E6%A0%87/name.jpg"><meta property="og:updated_time" content="2019-11-13T07:42:05.511Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="敏感数据识别和分级打标"><meta name="twitter:description" content="一、信息安全技术政务信息共享数据安全技术要求数据安全技术要求共享数据提供方在进行数据分级分类时的安全要求包括：应按照政务信息资源分级分类相关要求对共享数据分级分类并进行标记，根据标记可对数据安全等级进行识别，并需要保留标记记录，作为审计依据；应按照数据级别确定所必要的安全防护措施；应对共享数据分级分类的变更进行记录，并通知相关数据使用方；应明确使用方对共享数据的使用权限，包括是否允许数据存储、数"><meta name="twitter:image" content="https://www.browsersytle.cn/2019/11/13/%E6%95%8F%E6%84%9F%E6%95%B0%E6%8D%AE%E8%AF%86%E5%88%AB%E5%92%8C%E5%88%86%E7%BA%A7%E6%89%93%E6%A0%87/architecture.jpg"><link rel="canonical" href="https://www.browsersytle.cn/2019/11/13/敏感数据识别和分级打标.html"><link rel="alternate" href="/atom.xml" title="猪蹄胖的窝" type="application/atom+xml"><link rel="icon" href="/images/favicon.png" type="image/x-icon"><link rel="stylesheet" href="/blog/css/style.css"><link href="//cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.3.5/dist/jquery.fancybox.min.css" rel="stylesheet"></head><body class="main-center theme-black" itemscope itemtype="http://schema.org/WebPage"><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="slimContent"><div class="navbar-header"><div class="profile-block text-center"><a id="avatar" href="https://github.com/xiaoyunjie" target="_blank"><img class="img-circle img-rotate" src="/blog/images/personal.png" width="200" height="200"></a><h2 id="name" class="hidden-xs hidden-sm">猪蹄胖(Browser)</h2><h3 id="title" class="hidden-xs hidden-sm hidden-md">Operations and development</h3><small id="location" class="text-muted hidden-xs hidden-sm"><i class="icon icon-map-marker"></i> Suzhou, China</small></div><div class="search" id="search-form-wrap"><form class="search-form sidebar-form"><div class="input-group"><input type="text" class="search-form-input form-control" placeholder="搜索"> <span class="input-group-btn"><button type="submit" class="search-form-submit btn btn-flat" onclick="return!1"><i class="icon icon-search"></i></button></span></div></form><div class="ins-search"><div class="ins-search-mask"></div><div class="ins-search-container"><div class="ins-input-wrapper"><input type="text" class="ins-search-input" placeholder="想要查找什么..." x-webkit-speech> <button type="button" class="close ins-close ins-selectable" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button></div><div class="ins-section-wrapper"><div class="ins-section-container"></div></div></div></div></div><button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#main-navbar" aria-controls="main-navbar" aria-expanded="false"><span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span></button></div><nav id="main-navbar" class="collapse navbar-collapse" itemscope itemtype="http://schema.org/SiteNavigationElement" role="navigation"><ul class="nav navbar-nav main-nav menu-highlight"><li class="menu-item menu-item-home"><a href="/blog/."><i class="icon icon-home-fill"></i> <span class="menu-title">首页</span></a></li><li class="menu-item menu-item-archives"><a href="/blog/archives"><i class="icon icon-archives-fill"></i> <span class="menu-title">归档</span></a></li><li class="menu-item menu-item-categories"><a href="/blog/categories"><i class="icon icon-folder"></i> <span class="menu-title">分类</span></a></li><li class="menu-item menu-item-tags"><a href="/blog/tags"><i class="icon icon-tags"></i> <span class="menu-title">标签</span></a></li><li class="menu-item menu-item-repository"><a href="/blog/repository"><i class="icon icon-project"></i> <span class="menu-title">项目</span></a></li><li class="menu-item menu-item-books"><a href="/blog/books"><i class="icon icon-book-fill"></i> <span class="menu-title">书单</span></a></li><li class="menu-item menu-item-links"><a href="/blog/links"><i class="icon icon-friendship"></i> <span class="menu-title">友链</span></a></li><li class="menu-item menu-item-about"><a href="/blog/about"><i class="icon icon-cup-fill"></i> <span class="menu-title">关于</span></a></li></ul><ul class="social-links"><li><a href="https://github.com/xiaoyunjie" target="_blank" title="Github" data-toggle="tooltip" data-placement="top"><i class="icon icon-github"></i></a></li><li><a href="http://weibo.com/nupthot" target="_blank" title="Weibo" data-toggle="tooltip" data-placement="top"><i class="icon icon-weibo"></i></a></li><li><a href="/blog/atom.xml" target="_blank" title="Rss" data-toggle="tooltip" data-placement="top"><i class="icon icon-rss"></i></a></li></ul></nav></div></header><aside class="sidebar" itemscope itemtype="http://schema.org/WPSideBar"><div class="slimContent"><div class="widget"><h3 class="widget-title">公告</h3><div class="widget-body"><div id="board"><div class="content"><p>如果看到你喜欢的文章,请在留言板块点个赞,如果文章有错误,也请在流言板块反馈,不吝赐教。</p></div></div></div></div><div class="widget"><h3 class="widget-title">分类</h3><div class="widget-body"><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/blog/categories/Linux/">Linux</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/Nginx/">Nginx</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/SQL/">SQL</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/linux/">linux</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/network/">network</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/python/">python</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/大数据/">大数据</a><span class="category-list-count">1</span></li></ul></div></div><div class="widget"><h3 class="widget-title">标签</h3><div class="widget-body"><ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/basic/">basic</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/flask/">flask</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/limit/">limit</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/moloch/">moloch</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/openvpn/">openvpn</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/python/">python</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/qemu/">qemu</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/shell/">shell</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/tcp-udp/">tcp/udp</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/tcpdump/">tcpdump</a><span class="tag-list-count">1</span></li></ul></div></div><div class="widget"><h3 class="widget-title">标签云</h3><div class="widget-body tagcloud"><a href="/blog/tags/basic/" style="font-size:13px">basic</a> <a href="/blog/tags/flask/" style="font-size:13px">flask</a> <a href="/blog/tags/limit/" style="font-size:13px">limit</a> <a href="/blog/tags/moloch/" style="font-size:13px">moloch</a> <a href="/blog/tags/openvpn/" style="font-size:13px">openvpn</a> <a href="/blog/tags/python/" style="font-size:13px">python</a> <a href="/blog/tags/qemu/" style="font-size:13px">qemu</a> <a href="/blog/tags/shell/" style="font-size:13px">shell</a> <a href="/blog/tags/tcp-udp/" style="font-size:13px">tcp/udp</a> <a href="/blog/tags/tcpdump/" style="font-size:13px">tcpdump</a></div></div><div class="widget"><h3 class="widget-title">归档</h3><div class="widget-body"><ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2019/11/">十一月 2019</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2019/07/">七月 2019</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2019/06/">六月 2019</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2019/05/">五月 2019</a><span class="archive-list-count">1</span></li></ul></div></div><div class="widget"><h3 class="widget-title">最新文章</h3><div class="widget-body"><ul class="recent-post-list list-unstyled no-thumbnail"><li><div class="item-inner"><p class="item-category"><a class="category-link" href="/blog/categories/Linux/">Linux</a></p><p class="item-title"><a href="/blog/2019/11/13/Linux系统检测和防护脚本.html" class="title">Linux系统检测和防护脚本</a></p><p class="item-date"><time datetime="2019-11-13T07:52:47.000Z" itemprop="datePublished">2019-11-13</time></p></div></li><li><div class="item-inner"><p class="item-category"><a class="category-link" href="/blog/categories/大数据/">大数据</a></p><p class="item-title"><a href="/blog/2019/11/13/敏感数据识别和分级打标.html" class="title">敏感数据识别和分级打标</a></p><p class="item-date"><time datetime="2019-11-13T07:34:06.000Z" itemprop="datePublished">2019-11-13</time></p></div></li><li><div class="item-inner"><p class="item-category"><a class="category-link" href="/blog/categories/SQL/">SQL</a></p><p class="item-title"><a href="/blog/2019/07/22/SQL基础.html" class="title">SQL基础</a></p><p class="item-date"><time datetime="2019-07-22T14:32:03.000Z" itemprop="datePublished">2019-07-22</time></p></div></li><li><div class="item-inner"><p class="item-category"><a class="category-link" href="/blog/categories/network/">network</a></p><p class="item-title"><a href="/blog/2019/07/16/Tcpdump.html" class="title">Tcpdump</a></p><p class="item-date"><time datetime="2019-07-16T14:55:19.000Z" itemprop="datePublished">2019-07-16</time></p></div></li><li><div class="item-inner"><p class="item-category"><a class="category-link" href="/blog/categories/network/">network</a></p><p class="item-title"><a href="/blog/2019/07/16/理解TCP和UDP.html" class="title">理解TCP和UDP</a></p><p class="item-date"><time datetime="2019-07-16T14:41:22.000Z" itemprop="datePublished">2019-07-16</time></p></div></li></ul></div></div></div></aside><aside class="sidebar sidebar-toc collapse" id="collapseToc" itemscope itemtype="http://schema.org/WPSideBar"><div class="slimContent"><nav id="toc" class="article-toc"><h3 class="toc-title">文章目录</h3><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#一-信息安全技术政务信息共享数据安全技术要求"><span class="toc-number">1.</span> <span class="toc-text">一、信息安全技术政务信息共享数据安全技术要求</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#二-敏感数据识别和分级打标"><span class="toc-number">2.</span> <span class="toc-text">二、敏感数据识别和分级打标</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#三-敏感数据自动识别实现"><span class="toc-number">3.</span> <span class="toc-text">三、敏感数据自动识别实现</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#31-敏感字段标注方案"><span class="toc-number">3.1.</span> <span class="toc-text">3.1、敏感字段标注方案</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#32-敏感字段识别"><span class="toc-number">3.2.</span> <span class="toc-text">3.2、敏感字段识别</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#四-demo代码"><span class="toc-number">4.</span> <span class="toc-text">四、demo代码</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#41-识别mysql数据库中手机号码字段"><span class="toc-number">4.1.</span> <span class="toc-text">4.1、识别mysql数据库中手机号码字段</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#42-敏感数据识别规则"><span class="toc-number">4.2.</span> <span class="toc-text">4.2、敏感数据识别规则</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ip地址-正则表达式"><span class="toc-number">4.2.1.</span> <span class="toc-text">IP地址： 正则表达式</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#mac地址-正则表达式"><span class="toc-number">4.2.2.</span> <span class="toc-text">MAC地址: 正则表达式</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#ipv6地址-正则表达式"><span class="toc-number">4.2.3.</span> <span class="toc-text">IPv6地址: 正则表达式</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#手机号-正则表达式"><span class="toc-number">4.2.4.</span> <span class="toc-text">手机号： 正则表达式</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#银行卡-算法"><span class="toc-number">4.2.5.</span> <span class="toc-text">银行卡： 算法</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#身份证-算法"><span class="toc-number">4.2.6.</span> <span class="toc-text">身份证： 算法</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#地址自然语言处理工具包crf"><span class="toc-number">4.2.7.</span> <span class="toc-text">地址：自然语言处理工具包(CRF)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#姓名自然语言处理工具包crf"><span class="toc-number">4.2.8.</span> <span class="toc-text">姓名：自然语言处理工具包(CRF)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#性别-正则表达式"><span class="toc-number">4.2.9.</span> <span class="toc-text">性别： 正则表达式</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#民族-正则表达式"><span class="toc-number">4.2.10.</span> <span class="toc-text">民族： 正则表达式</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#省份-正则表达式"><span class="toc-number">4.2.11.</span> <span class="toc-text">省份： 正则表达式</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#车牌号-正则表达式"><span class="toc-number">4.2.12.</span> <span class="toc-text">车牌号： 正则表达式</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#电话号码-正则表达式"><span class="toc-number">4.2.13.</span> <span class="toc-text">电话号码： 正则表达式</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#军官证正则表达式"><span class="toc-number">4.2.14.</span> <span class="toc-text">军官证：正则表达式</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#邮箱-正则表达式"><span class="toc-number">4.2.15.</span> <span class="toc-text">邮箱： 正则表达式</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#护照号-正则表达式"><span class="toc-number">4.2.16.</span> <span class="toc-text">护照号： 正则表达式</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#港澳通行证-正则表达式"><span class="toc-number">4.2.17.</span> <span class="toc-text">港澳通行证： 正则表达式</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#jdbc连接串-正则表达式"><span class="toc-number">4.2.18.</span> <span class="toc-text">JDBC连接串： 正则表达式</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#日期正则表达式"><span class="toc-number">4.2.19.</span> <span class="toc-text">日期：正则表达式</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#车辆识别代码正则表达式"><span class="toc-number">4.2.20.</span> <span class="toc-text">车辆识别代码：正则表达式</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#组织机构代码算法"><span class="toc-number">4.2.21.</span> <span class="toc-text">组织机构代码：算法</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#营业执照号码-算法"><span class="toc-number">4.2.22.</span> <span class="toc-text">营业执照号码 ：算法</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#统一社会信用代码算法"><span class="toc-number">4.2.23.</span> <span class="toc-text">统一社会信用代码：算法</span></a></li></ol></li></ol></li></ol></nav></div></aside><main class="main" role="main"><div class="content"><article id="post-敏感数据识别和分级打标" class="article article-type-post" itemscope itemtype="http://schema.org/BlogPosting"><div class="article-header"><h1 class="article-title" itemprop="name">敏感数据识别和分级打标</h1><div class="article-meta"><span class="article-date"><i class="icon icon-calendar-check"></i> <a href="/blog/2019/11/13/敏感数据识别和分级打标.html" class="article-date"><time datetime="2019-11-13T07:34:06.000Z" itemprop="datePublished">2019-11-13</time></a></span> <span class="article-category"><i class="icon icon-folder"></i> <a class="article-category-link" href="/blog/categories/大数据/">大数据</a></span> <span class="article-tag"><i class="icon icon-tags"></i> <a class="article-tag-link" href="/blog/tags/python/">python</a></span> <span class="article-read hidden-xs"><i class="icon icon-eye-fill" aria-hidden="true"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span> </span></span><span class="article-read hidden-xs"><i class="icon icon-eye-fill" aria-hidden="true"></i> <span id="/blog/2019/11/13/敏感数据识别和分级打标.html" class="leancloud_visitors" data-flag-title="敏感数据识别和分级打标">0</span></span> <span class="post-comment"><i class="icon icon-comment"></i> <a href="/blog/2019/11/13/敏感数据识别和分级打标.html#comments" class="article-comment-link">评论</a></span> <span class="post-wordcount hidden-xs" itemprop="wordCount">字数统计: 4k(字)</span> <span class="post-readcount hidden-xs" itemprop="timeRequired">阅读时长: 19(分)</span></div></div><div class="article-entry marked-body" itemprop="articleBody"><h3 id="一-信息安全技术政务信息共享数据安全技术要求"><a class="markdownIt-Anchor" href="#一-信息安全技术政务信息共享数据安全技术要求"></a> 一、信息安全技术政务信息共享数据安全技术要求</h3><p><strong>数据安全技术要求</strong><br>共享数据提供方在进行数据分级分类时的安全要求包括：</p><ul><li>应按照政务信息资源分级分类相关要求对共享数据分级分类并进行标记，根据标记可对数据安全等级进行识别，并需要保留标记记录，作为审计依据；</li><li>应按照数据级别确定所必要的安全防护措施；</li><li>应对共享数据分级分类的变更进行记录，并通知相关数据使用方；</li><li>应明确使用方对共享数据的使用权限，包括是否允许数据存储、数据存储保护要求、是否允许使用方提供给第三方等。</li></ul><hr><h3 id="二-敏感数据识别和分级打标"><a class="markdownIt-Anchor" href="#二-敏感数据识别和分级打标"></a> 二、敏感数据识别和分级打标</h3><p><strong>数据分级分类的原则</strong></p><ul><li><code>分类：</code> 依据数据的来源、内容和用途对数据进行分类；</li><li><code>分级：</code> 按照数据的价值、内容敏感程度、影响和分发范围不同对数据进行敏感级别划分。</li></ul><p><strong>数据分级分类方式</strong></p><ul><li>根据梳理出的备案数据资产，进行敏感数据的自动探测，通过特征探测定位敏感数据分布在哪些数据资产中；</li><li>针对敏感的数据资产进行分级分类标记，分类出敏感数据所有者（部门、系统、管理人员等）；</li><li>根据已分类的数据资产由业务部门进行敏感分级，将分类的数据资产划分公开、内部、敏感等不同的敏感级别。</li></ul><p><strong>敏感数据识别</strong></p><blockquote><p>通过用户自定义规则，自动识别敏感数据<br>使用自带的规则或自定义规则，对其结构化表或者非结构化文件进行整体扫描、分级</p></blockquote><p><img src="%E6%95%8F%E6%84%9F%E6%95%B0%E6%8D%AE%E8%AF%86%E5%88%AB%E5%92%8C%E5%88%86%E7%BA%A7%E6%89%93%E6%A0%87/architecture.jpg" alt></p><h3 id="三-敏感数据自动识别实现"><a class="markdownIt-Anchor" href="#三-敏感数据自动识别实现"></a> 三、敏感数据自动识别实现</h3><h4 id="31-敏感字段标注方案"><a class="markdownIt-Anchor" href="#31-敏感字段标注方案"></a> 3.1、敏感字段标注方案</h4><p>**敏感字段包括： **<br><code>统一社会信用代码，车辆识别代码，营业执照号码，税务登记证号码，组织机构代码，图片，日期，IP地址，MAC地址，城市，性别，民族，省份，车牌号，电话号码，军官证，邮箱，护照号，港澳通行证，姓名，地址，手机号，身份证，银行卡</code>。</p><p><strong>发现敏感字段方法</strong></p><ul><li>定期全库扫描，识别敏感字段 （周期触发）。</li><li>新增或修改表和字段，增量扫描识别出敏感字段。<code>需要监听数据库对表或字段的操作，来指定表或字段进行敏感识别扫描，需结合数据库代理服务</code></li><li>手动触发扫描</li></ul><h4 id="32-敏感字段识别"><a class="markdownIt-Anchor" href="#32-敏感字段识别"></a> 3.2、敏感字段识别</h4><p>识别方式：<code>正则匹配</code>，<code>关键字</code>，<code>算法</code></p><ul><li>银行卡号、证件号、手机号，有明确的规则，可以根据正则表达式和算法匹配</li><li>姓名、特殊字段，没有明确信息，可能是任意字符串，可以通过配置关键字来进行匹配</li><li>营业执照、地址、图片等，没有明确规则，可以通过自然语言算法来识别，使用开源算法库</li></ul><p><strong>数据识别问题</strong></p><ul><li>全库扫描占用资源较大，是否可以使用采样的方式</li><li>脏数据的判断识别，有的字段是NULL或者空格的，是否可以直接默认是定义为敏感级别</li><li>数据打标，是对全库字段打标，还是只对采样数据进行打标，并单独存库用走后期的统计分析</li></ul><h3 id="四-demo代码"><a class="markdownIt-Anchor" href="#四-demo代码"></a> 四、demo代码</h3><h4 id="41-识别mysql数据库中手机号码字段"><a class="markdownIt-Anchor" href="#41-识别mysql数据库中手机号码字段"></a> 4.1、识别mysql数据库中手机号码字段</h4><p>对指定的mysql实例下的所有库、所有表、所有字段，遍历去匹配正则表达式，然后进行标记。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">@Author     :   Browser</span></span><br><span class="line"><span class="string">@file       :   identity_mysql.py </span></span><br><span class="line"><span class="string">@time       :   2019/09/30</span></span><br><span class="line"><span class="string">@software   :   PyCharm </span></span><br><span class="line"><span class="string">@description:   " "</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> pymysql</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">s1 = <span class="string">"无风险"</span></span><br><span class="line">s2 = <span class="string">"低风险"</span></span><br><span class="line">s3 = <span class="string">"中风险"</span></span><br><span class="line">s4 = <span class="string">"高风险"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 通过正则匹配出个人手机号码</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">check_secret</span><span class="params">(value)</span>:</span></span><br><span class="line">    phone_pattern = <span class="string">'^[1](([3][0-9])|([4][5-9])|([5][0-3,5-9])|([6][5,6])|([7][0-8])|([8][0-9])|([9][1,8,9]))[0-9]&#123;8&#125;$'</span></span><br><span class="line">    <span class="keyword">if</span> re.match(phone_pattern, value):</span><br><span class="line">        <span class="keyword">return</span> (<span class="string">'%s'</span> % s3)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> (<span class="string">'%s'</span> % s1)</span><br><span class="line">        </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DB</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,ip,username,password)</span>:</span></span><br><span class="line">        self.ip = ip</span><br><span class="line">        self.username = username</span><br><span class="line">        self.password = password</span><br><span class="line">        self.db = pymysql.connect(self.ip,self.username,self.password)</span><br><span class="line">        self.cursor = self.db.cursor()</span><br><span class="line"></span><br><span class="line">    <span class="comment">#  通过schemata获取所有数据库名称</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_database</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.cursor.execute(<span class="string">"SELECT schema_name from information_schema.schemata "</span>)</span><br><span class="line">        database_list = self.cursor.fetchall()</span><br><span class="line">        result = []</span><br><span class="line">        <span class="keyword">for</span> line <span class="keyword">in</span> database_list:</span><br><span class="line">            <span class="keyword">if</span> line[<span class="number">0</span>] <span class="keyword">not</span> <span class="keyword">in</span> [<span class="string">'information_schema'</span>,<span class="string">'mysql'</span>,<span class="string">'performance_schema'</span>,<span class="string">'sys'</span>,<span class="string">'loonflownew'</span>]:   <span class="comment">#排除默认的数据库</span></span><br><span class="line">                result.append(line[<span class="number">0</span>])</span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line">    <span class="comment">#  获取表名</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_table</span><span class="params">(self,database)</span>:</span></span><br><span class="line">        self.cursor.execute(<span class="string">"select table_name from information_schema.tables where table_schema= '%s' "</span> % database)</span><br><span class="line">        table_list = self.cursor.fetchall()</span><br><span class="line">        result = []</span><br><span class="line">        <span class="keyword">for</span> line <span class="keyword">in</span> table_list:</span><br><span class="line">            result.append(line[<span class="number">0</span>])</span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line">    <span class="comment">#  获取字段名</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_column</span><span class="params">(self,database,table)</span>:</span></span><br><span class="line">        self.cursor.execute(<span class="string">"select column_name from information_schema.columns where table_schema='%s' and table_name='%s'"</span> % (database,table))</span><br><span class="line">        column_list = self.cursor.fetchall()</span><br><span class="line">        result = []</span><br><span class="line">        <span class="keyword">for</span> line <span class="keyword">in</span> column_list:</span><br><span class="line">            result.append(line[<span class="number">0</span>])</span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line">    <span class="comment">#  获取字段内容</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_content</span><span class="params">(self,database,table,column)</span>:</span></span><br><span class="line">        self.cursor.execute(<span class="string">"select %s from %s.%s LIMIT 0,1"</span> %(column,database,table))</span><br><span class="line">        content = self.cursor.fetchall()</span><br><span class="line">        <span class="keyword">if</span> content:</span><br><span class="line">            <span class="keyword">return</span> content[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__del__</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.db.close()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">        <span class="comment"># db = DB('192.168.189.154','root','Gepoint')</span></span><br><span class="line">        db = DB(<span class="string">'rm-bp1i3518ykiqi60my8o.mysql.rds.aliyuncs.com'</span>,<span class="string">'root'</span>,<span class="string">'Epoint@123@)!('</span>)</span><br><span class="line">        databases = db.get_database()</span><br><span class="line">        <span class="keyword">for</span> database <span class="keyword">in</span> databases:</span><br><span class="line">            tables = db.get_table(database)</span><br><span class="line">            <span class="keyword">for</span> table <span class="keyword">in</span> tables:</span><br><span class="line">                columns = db.get_column(database,table)</span><br><span class="line">                <span class="keyword">for</span> column <span class="keyword">in</span> columns:</span><br><span class="line">                    data = db.get_content(database,table,column)</span><br><span class="line">                    data_str = str(data)</span><br><span class="line">                    result = [database,table,column,data_str,check_secret(data_str)]</span><br><span class="line">                    result_str = str(result) + <span class="string">"\r\n"</span></span><br><span class="line">                    <span class="keyword">with</span> open(<span class="string">'message.txt'</span>,<span class="string">'a+'</span>,encoding=<span class="string">'UTF-8'</span>) <span class="keyword">as</span> file:</span><br><span class="line">                        file.write(result_str)</span><br></pre></td></tr></table></figure><h4 id="42-敏感数据识别规则"><a class="markdownIt-Anchor" href="#42-敏感数据识别规则"></a> 4.2、敏感数据识别规则</h4><h5 id="ip地址-正则表达式"><a class="markdownIt-Anchor" href="#ip地址-正则表达式"></a> IP地址： 正则表达式</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#精确匹配IP地址</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">check_ip</span><span class="params">(value)</span>:</span></span><br><span class="line">    ip_pattern = <span class="string">r'^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.)&#123;3&#125;(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$'</span></span><br><span class="line">    <span class="keyword">if</span> re.match(ip_pattern, value):</span><br><span class="line">        print(<span class="string">'%s'</span> % s2)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print(<span class="string">'%s'</span> % s1)</span><br></pre></td></tr></table></figure><h5 id="mac地址-正则表达式"><a class="markdownIt-Anchor" href="#mac地址-正则表达式"></a> MAC地址: 正则表达式</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#精确匹配MAC地址</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">check_mac</span><span class="params">(value)</span>:</span></span><br><span class="line">    mac_pattern = <span class="string">r'^(?:(?:(?:[a-f0-9A-F]&#123;2&#125;:)&#123;5&#125;)|(?:(?:[a-f0-9A-F]&#123;2&#125;-)&#123;5&#125;))[a-f0-9A-F]&#123;2&#125;$'</span></span><br><span class="line">    <span class="keyword">if</span> re.match(mac_pattern, value):</span><br><span class="line">        print(<span class="string">'%s'</span> % s2)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print(<span class="string">'%s'</span> % s1)</span><br></pre></td></tr></table></figure><h5 id="ipv6地址-正则表达式"><a class="markdownIt-Anchor" href="#ipv6地址-正则表达式"></a> IPv6地址: 正则表达式</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">check_ipv6</span><span class="params">(value)</span>:</span></span><br><span class="line">    ipv6_pattern =</span><br><span class="line"><span class="string">r'^\s*((([0-9A-Fa-f]&#123;1,4&#125;:)&#123;7&#125;([0-9A-Fa-f]&#123;1,4&#125;|:))|(([0-9A-Fa-f]&#123;1,4&#125;:)&#123;6&#125;(:[0-9A-Fa-f]&#123;1,4&#125;|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d))&#123;3&#125;)|:))|(([0-9A-Fa-f]&#123;1,4&#125;:)&#123;5&#125;(((:[0-9A-Fa-f]&#123;1,4&#125;)&#123;1,2&#125;)|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d))&#123;3&#125;)|:))|(([0-9A-Fa-f]&#123;1,4&#125;:)&#123;4&#125;(((:[0-9A-Fa-f]&#123;1,4&#125;)&#123;1,3&#125;)|((:[0-9A-Fa-f]&#123;1,4&#125;)?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d))&#123;3&#125;))|:))|(([0-9A-Fa-f]&#123;1,4&#125;:)&#123;3&#125;(((:[0-9A-Fa-f]&#123;1,4&#125;)&#123;1,4&#125;)|((:[0-9A-Fa-f]&#123;1,4&#125;)&#123;0,2&#125;:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d))&#123;3&#125;))|:))|(([0-9A-Fa-f]&#123;1,4&#125;:)&#123;2&#125;(((:[0-9A-Fa-f]&#123;1,4&#125;)&#123;1,5&#125;)|((:[0-9A-Fa-f]&#123;1,4&#125;)&#123;0,3&#125;:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d))&#123;3&#125;))|:))|(([0-9A-Fa-f]&#123;1,4&#125;:)&#123;1&#125;(((:[0-9A-Fa-f]&#123;1,4&#125;)&#123;1,6&#125;)|((:[0-9A-Fa-f]&#123;1,4&#125;)&#123;0,4&#125;:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d))&#123;3&#125;))|:))|(:(((:[0-9A-Fa-f]&#123;1,4&#125;)&#123;1,7&#125;)|((:[0-9A-Fa-f]&#123;1,4&#125;)&#123;0,5&#125;:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d))&#123;3&#125;))|:)))(%.+)?\s*$'</span></span><br><span class="line">    <span class="keyword">if</span> re.match(ipv6_pattern, value):</span><br><span class="line">        print(<span class="string">'%s'</span> % s2)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print(<span class="string">'%s'</span> % s1)</span><br></pre></td></tr></table></figure><h5 id="手机号-正则表达式"><a class="markdownIt-Anchor" href="#手机号-正则表达式"></a> 手机号： 正则表达式</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">check_phone</span><span class="params">(value)</span>:</span></span><br><span class="line">    phone_pattern = <span class="string">r'^[1](([3][0-9])|([4][5-9])|([5][0-3,5-9])|([6][5,6])|([7][0-8])|([8][0-9])|([9][1,8,9]))[0-9]&#123;8&#125;$'</span></span><br><span class="line">    <span class="keyword">if</span> re.match(phone_pattern, value):</span><br><span class="line">        print(<span class="string">'%s'</span> % s3)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print(<span class="string">'%s'</span> % s1)</span><br></pre></td></tr></table></figure><h5 id="银行卡-算法"><a class="markdownIt-Anchor" href="#银行卡-算法"></a> 银行卡： 算法</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">check_bank_card</span><span class="params">(card_num)</span>:</span></span><br><span class="line">    total = <span class="number">0</span></span><br><span class="line">    card_num_length = len(card_num)</span><br><span class="line">    <span class="keyword">for</span> item <span class="keyword">in</span> range(<span class="number">1</span>, card_num_length + <span class="number">1</span>):</span><br><span class="line">        t = int(card_num[card_num_length - item])</span><br><span class="line">        <span class="keyword">if</span> item % <span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">            t *= <span class="number">2</span></span><br><span class="line">            total += t <span class="keyword">if</span> t &lt; <span class="number">10</span> <span class="keyword">else</span> t % <span class="number">10</span> + t // <span class="number">10</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            total += t</span><br><span class="line">    <span class="keyword">return</span> total % <span class="number">10</span> == <span class="number">0</span></span><br></pre></td></tr></table></figure><h5 id="身份证-算法"><a class="markdownIt-Anchor" href="#身份证-算法"></a> 身份证： 算法</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">check_IDNumber</span><span class="params">(value)</span>:</span></span><br><span class="line">    str_to_int = &#123;<span class="string">'0'</span>: <span class="number">0</span>, <span class="string">'1'</span>: <span class="number">1</span>, <span class="string">'2'</span>: <span class="number">2</span>, <span class="string">'3'</span>: <span class="number">3</span>, <span class="string">'4'</span>: <span class="number">4</span>, <span class="string">'5'</span>: <span class="number">5</span>,</span><br><span class="line">                  <span class="string">'6'</span>: <span class="number">6</span>, <span class="string">'7'</span>: <span class="number">7</span>, <span class="string">'8'</span>: <span class="number">8</span>, <span class="string">'9'</span>: <span class="number">9</span>, <span class="string">'X'</span>: <span class="number">10</span>&#125;</span><br><span class="line">    check_dict = &#123;<span class="number">0</span>: <span class="string">'1'</span>, <span class="number">1</span>: <span class="string">'0'</span>, <span class="number">2</span>: <span class="string">'X'</span>, <span class="number">3</span>: <span class="string">'9'</span>, <span class="number">4</span>: <span class="string">'8'</span>, <span class="number">5</span>: <span class="string">'7'</span>,</span><br><span class="line">                  <span class="number">6</span>: <span class="string">'6'</span>, <span class="number">7</span>: <span class="string">'5'</span>, <span class="number">8</span>: <span class="string">'4'</span>, <span class="number">9</span>: <span class="string">'3'</span>, <span class="number">10</span>: <span class="string">'2'</span>&#125;</span><br><span class="line">    <span class="keyword">if</span> len(value) != <span class="number">18</span>:</span><br><span class="line">        <span class="keyword">raise</span> TypeError(<span class="string">u'请输入标准的第二代身份证号码'</span>)</span><br><span class="line">    check_num = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> index, num <span class="keyword">in</span> enumerate(value):</span><br><span class="line">        <span class="keyword">if</span> index == <span class="number">17</span>:</span><br><span class="line">            verify_code = check_dict.get(check_num % <span class="number">11</span>)</span><br><span class="line">            <span class="keyword">if</span> num == verify_code:</span><br><span class="line">                print(<span class="string">u"身份证号: %s, 校验通过,"</span> % value + s4)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                print(<span class="string">u"身份证号: %s, 校验不通过, 正确尾号应该为：%s,"</span> % (value, verify_code) + s1)</span><br><span class="line">        check_num += str_to_int.get(num) * (<span class="number">2</span> ** (<span class="number">17</span> - index) % <span class="number">11</span>)</span><br></pre></td></tr></table></figure><h5 id="地址自然语言处理工具包crf"><a class="markdownIt-Anchor" href="#地址自然语言处理工具包crf"></a> 地址：自然语言处理工具包(CRF)</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re,sys</span><br><span class="line"><span class="keyword">from</span> pyhanlp <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">s1 = <span class="string">"无风险"</span></span><br><span class="line">s2 = <span class="string">"低风险"</span></span><br><span class="line">s3 = <span class="string">"中风险"</span></span><br><span class="line">s4 = <span class="string">"高风险"</span></span><br><span class="line"></span><br><span class="line">value = sys.argv[<span class="number">1</span>]</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">check_chinese_address_recognition</span><span class="params">(value)</span>:</span></span><br><span class="line">    CRFnewSegment = HanLP.newSegment(<span class="string">"crf"</span>)</span><br><span class="line">    address_list = CRFnewSegment.seg(value)</span><br><span class="line">    dict = &#123;&#125;</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> address_list:</span><br><span class="line">        dict[str(i.word)] = [str(i.nature)]</span><br><span class="line">    Address = <span class="string">r'(ns|nsf)'</span></span><br><span class="line">    <span class="keyword">for</span> key,value <span class="keyword">in</span> dict.items():</span><br><span class="line">        value = str(value)</span><br><span class="line">        <span class="keyword">if</span> re.search(Address,value):</span><br><span class="line">            print(<span class="string">'地址：%s'</span> % key + <span class="string">'，风险等级：'</span> + s3)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            print(<span class="string">'常规词：%s'</span> % key + <span class="string">'，风险等级：'</span> + s1)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    check_chinese_address_recognition(value)</span><br></pre></td></tr></table></figure><p><img src="%E6%95%8F%E6%84%9F%E6%95%B0%E6%8D%AE%E8%AF%86%E5%88%AB%E5%92%8C%E5%88%86%E7%BA%A7%E6%89%93%E6%A0%87/place.jpg" alt></p><h5 id="姓名自然语言处理工具包crf"><a class="markdownIt-Anchor" href="#姓名自然语言处理工具包crf"></a> 姓名：自然语言处理工具包(CRF)</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys,re</span><br><span class="line"><span class="keyword">from</span> pyhanlp <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">s1 = <span class="string">"无风险"</span></span><br><span class="line">s2 = <span class="string">"低风险"</span></span><br><span class="line">s3 = <span class="string">"中风险"</span></span><br><span class="line">s4 = <span class="string">"高风险"</span></span><br><span class="line">value = sys.argv[<span class="number">1</span>]</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">check_chinese_name_recognition</span><span class="params">(value)</span>:</span></span><br><span class="line">    CRFnewSegment = HanLP.newSegment(<span class="string">"crf"</span>)</span><br><span class="line">    name_list = CRFnewSegment.seg(value)</span><br><span class="line">    dict = &#123;&#125;</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> name_list:</span><br><span class="line">        dict[str(i.word)] = [str(i.nature)]</span><br><span class="line">    Person_Name = <span class="string">r'nr'</span></span><br><span class="line">    <span class="keyword">for</span> key,value <span class="keyword">in</span> dict.items():</span><br><span class="line">        result = str(value)</span><br><span class="line">        <span class="keyword">if</span> re.search(Person_Name,result):</span><br><span class="line">            print(<span class="string">'姓名：%s'</span> % key + <span class="string">'，风险等级：'</span> + s4)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            print(<span class="string">'常规词：%s'</span> % key + <span class="string">'，风险等级：'</span> + s1)</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    check_chinese_name_recognition(value)</span><br></pre></td></tr></table></figure><p><img src="%E6%95%8F%E6%84%9F%E6%95%B0%E6%8D%AE%E8%AF%86%E5%88%AB%E5%92%8C%E5%88%86%E7%BA%A7%E6%89%93%E6%A0%87/name.jpg" alt></p><h5 id="性别-正则表达式"><a class="markdownIt-Anchor" href="#性别-正则表达式"></a> 性别： 正则表达式</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">check_gender</span><span class="params">(value)</span>:</span></span><br><span class="line">    gender_pattern = <span class="string">r'^((男|male)|(女|female))$'</span></span><br><span class="line">    <span class="keyword">if</span> re.match(gender_pattern,value):</span><br><span class="line">        print(<span class="string">'%s'</span> % s2)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print(<span class="string">'%s'</span> % s1)</span><br></pre></td></tr></table></figure><h5 id="民族-正则表达式"><a class="markdownIt-Anchor" href="#民族-正则表达式"></a> 民族： 正则表达式</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">check_national</span><span class="params">(value)</span>:</span></span><br><span class="line">    national_pattern = <span class="string">r'^((汉|满|蒙古|回|藏|维吾尔|苗|彝|壮|布依|侗|瑶|白|土家|哈尼|哈萨克|傣|黎'</span> \</span><br><span class="line">                       <span class="string">r'|傈僳|佤|畲|高山|拉祜|水|东乡|纳西|景颇|柯尔克孜|土|达斡尔|仫佬|羌|布朗'</span> \</span><br><span class="line">                       <span class="string">r'|撒拉|毛南|仡佬|锡伯|阿昌|普米|朝鲜|塔吉克|怒|乌孜别克|俄罗斯|鄂温克|德昂'</span> \</span><br><span class="line">                       <span class="string">r'|保安|裕固|京|塔塔尔|独龙|鄂伦春|赫哲|门巴|珞巴|基诺)'</span> \</span><br><span class="line">                       <span class="string">r'|(汉族|满族|蒙古族|回族|藏族|维吾尔族|苗族|彝族|壮族|布依族|侗族|瑶族|白族|'</span> \</span><br><span class="line">                       <span class="string">r'土家族|哈尼族|哈萨克族|傣族|黎族|傈僳族|佤族|畲族|高山族|拉祜族|水族|东乡族|'</span> \</span><br><span class="line">                       <span class="string">r'纳西族|景颇族|柯尔克孜族|土族|达斡尔族|仫佬族|羌族|布朗族|撒拉族|毛南族|仡佬族|'</span> \</span><br><span class="line">                       <span class="string">r'锡伯族|阿昌族|普米族|朝鲜族|塔吉克族|怒族|乌孜别克族|俄罗斯族|鄂温克族|德昂族|'</span> \</span><br><span class="line">                       <span class="string">r'保安族|裕固族|京族|塔塔尔族|独龙族|鄂伦春族|赫哲族|门巴族|珞巴族|基诺族))$'</span></span><br><span class="line">    <span class="keyword">if</span> re.match(national_pattern,value):</span><br><span class="line">        print(<span class="string">'%s'</span> % s3)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print(<span class="string">'%s'</span> % s1)</span><br></pre></td></tr></table></figure><h5 id="省份-正则表达式"><a class="markdownIt-Anchor" href="#省份-正则表达式"></a> 省份： 正则表达式</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">check_provinces</span><span class="params">(value)</span>:</span></span><br><span class="line">    provinces_pattern = <span class="string">r'^(北京市|天津市|上海市|重庆市|河北省|山西省|辽宁省|吉林省|黑龙江省|江苏省|'</span> \</span><br><span class="line">                        <span class="string">r'浙江省|安徽省|福建省|江西省|山东省|河南省|湖北省|湖南省|广东省|海南省|四川省|'</span> \</span><br><span class="line">                        <span class="string">r'贵州省|云南省|陕西省|甘肃省|青海省|台湾省|内蒙古自治区|广西壮族自治区|西藏自治区|'</span>\</span><br><span class="line">                        <span class="string">r'宁夏回族自治区|新疆维吾尔自治区|香港特别行政区|澳门特别行政区)$'</span></span><br><span class="line">    <span class="keyword">if</span> re.match(provinces_pattern,value):</span><br><span class="line">        print(<span class="string">'%s'</span> % s2)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print(<span class="string">'%s'</span> % s1)</span><br></pre></td></tr></table></figure><h5 id="车牌号-正则表达式"><a class="markdownIt-Anchor" href="#车牌号-正则表达式"></a> 车牌号： 正则表达式</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">check_carnum</span><span class="params">(value)</span>:</span></span><br><span class="line">    carnum_pattern = <span class="string">r'([京津沪渝冀豫云辽黑湘皖鲁新苏浙赣鄂桂甘晋蒙陕吉闽贵粤青藏川宁琼使领A-Z]'</span> \</span><br><span class="line">                     <span class="string">r'&#123;1&#125;[A-Z]&#123;1&#125;(([0-9]&#123;5&#125;[DF])|(DF[0-9]&#123;4&#125;)))|'</span> \</span><br><span class="line">                     <span class="string">r'([京津沪渝冀豫云辽黑湘皖鲁新苏浙赣鄂桂甘晋蒙陕吉闽贵粤青藏川宁琼使领A-Z]'</span> \</span><br><span class="line">                     <span class="string">r'&#123;1&#125;[A-Z]&#123;1&#125;[A-HJ-NP-Z0-9]&#123;4&#125;[A-HJ-NP-Z0-9挂学警港澳]&#123;1&#125;)'</span></span><br><span class="line">    <span class="keyword">if</span> re.match(carnum_pattern,value):</span><br><span class="line">        print(<span class="string">'%s'</span> % s3)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print(<span class="string">'%s'</span> % s1)</span><br></pre></td></tr></table></figure><h5 id="电话号码-正则表达式"><a class="markdownIt-Anchor" href="#电话号码-正则表达式"></a> 电话号码： 正则表达式</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">check_telephone</span><span class="params">(value)</span>:</span></span><br><span class="line">    telephone_pattern = <span class="string">r'^((0\d&#123;2,3&#125;)-)(\d&#123;7,8&#125;)|(\d&#123;7,8&#125;)$'</span></span><br><span class="line">    <span class="keyword">if</span> re.match(telephone_pattern,value):</span><br><span class="line">        print(<span class="string">'%s'</span> % s3)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print(<span class="string">'%s'</span> % s1)</span><br></pre></td></tr></table></figure><h5 id="军官证正则表达式"><a class="markdownIt-Anchor" href="#军官证正则表达式"></a> 军官证：正则表达式</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">check_officer</span><span class="params">(value)</span>:</span></span><br><span class="line">    officer_pattern = <span class="string">r'^[\u4E00-\u9FA5](字第)([0-9a-zA-Z]&#123;4,8&#125;)(号?)$'</span></span><br><span class="line">    <span class="keyword">if</span> re.match(officer_pattern,value):</span><br><span class="line">        print(<span class="string">'%s'</span> % s3)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print(<span class="string">'%s'</span> % s1)</span><br></pre></td></tr></table></figure><h5 id="邮箱-正则表达式"><a class="markdownIt-Anchor" href="#邮箱-正则表达式"></a> 邮箱： 正则表达式</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">check_email</span><span class="params">(value)</span>:</span></span><br><span class="line">    email_pattern = <span class="string">r'[\w-]+@[\w-]+(.[\w-]+)+'</span></span><br><span class="line">    <span class="keyword">if</span> re.match(email_pattern, value):</span><br><span class="line">        print(<span class="string">'%s'</span> % s2)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print(<span class="string">'%s'</span> % s1)</span><br></pre></td></tr></table></figure><h5 id="护照号-正则表达式"><a class="markdownIt-Anchor" href="#护照号-正则表达式"></a> 护照号： 正则表达式</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">check_passport</span><span class="params">(value)</span>:</span></span><br><span class="line">    passport_pattern = <span class="string">r'^([a-zA-z]|[0-9])&#123;5,17&#125;$'</span></span><br><span class="line">    <span class="keyword">if</span> re.match(passport_pattern,value):</span><br><span class="line">        print(<span class="string">'%s'</span> % s3)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print(<span class="string">'%s'</span> % s1)</span><br></pre></td></tr></table></figure><h5 id="港澳通行证-正则表达式"><a class="markdownIt-Anchor" href="#港澳通行证-正则表达式"></a> 港澳通行证： 正则表达式</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">check_HM_pass</span><span class="params">(value)</span>:</span></span><br><span class="line">    HM_pass_pattern = <span class="string">r'^[HMhm]&#123;1&#125;([0-9]&#123;10&#125;|[0-9]&#123;8&#125;)$'</span></span><br><span class="line">    <span class="keyword">if</span> re.match(HM_pass_pattern, value):</span><br><span class="line">        print(<span class="string">'%s'</span> % s3)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print(<span class="string">'%s'</span> % s1)</span><br></pre></td></tr></table></figure><h5 id="jdbc连接串-正则表达式"><a class="markdownIt-Anchor" href="#jdbc连接串-正则表达式"></a> JDBC连接串： 正则表达式</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">check_jdbc</span><span class="params">(value)</span>:</span></span><br><span class="line">    jdbc_pattern =</span><br><span class="line"><span class="string">r'^jdbc:(((microsoft:)?sqlserver:\/\/((25[0-5]|2[0-4]\d|[0-1]\d&#123;2&#125;|[1-9]?\d)\.(25[0-5]|2[0-4]\d|[0-1]\d&#123;2&#125;|[1-9]?\d)\.(25[0-5]|2[0-4]\d|[0-1]\d&#123;2&#125;|[1-9]?\d)\.(25[0-5]|2[0-4]\d|[0-1]\d&#123;2&#125;|[1-9]?\d)):(([1-9]([0-9]&#123;0,3&#125;))|([1-6][0-5][0-5][0-3][0-5]))(;[</span></span><br><span class="line"><span class="string">\d\w\/=\?%\-&amp;_~`@[\]\':+!]*)?)|'</span> \</span><br><span class="line">                   <span class="string">r'(oracle:thin:@((25[0-5]|2[0-4]\d|[0-1]\d&#123;2&#125;|[1-9]?\d)\.(25[0-5]|2[0-4]\d|[0-1]\d&#123;2&#125;|[1-9]?\d)\.(25[0-5]|2[0-4]\d|[0-1]\d&#123;2&#125;|[1-9]?\d)\.(25[0-5]|2[0-4]\d|[0-1]\d&#123;2&#125;|[1-9]?\d)):(([1-9]([0-9]&#123;0,3&#125;))|([1-6][0-5][0-5][0-3][0-5])):[A-Za-z0-9_]+)|'</span></span><br><span class="line">\</span><br><span class="line">                   <span class="string">r'(mysql:\/\/((25[0-5]|2[0-4]\d|[0-1]\d&#123;2&#125;|[1-9]?\d)\.(25[0-5]|2[0-4]\d|[0-1]\d&#123;2&#125;|[1-9]?\d)\.(25[0-5]|2[0-4]\d|[0-1]\d&#123;2&#125;|[1-9]?\d)\.(25[0-5]|2[0-4]\d|[0-1]\d&#123;2&#125;|[1-9]?\d)):(([1-9]([0-9]&#123;0,3&#125;))|([1-6][0-5][0-5][0-3][0-5]))\/([A-Za-z0-9_]+)(\?([\d\w\/=\?%\-&amp;_~`@[\]\':+!]*))?))$'</span></span><br><span class="line">    <span class="keyword">if</span> re.match(jdbc_pattern,value):</span><br><span class="line">        print(<span class="string">'%s'</span> % s4)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print(<span class="string">'%s'</span> % s1)</span><br></pre></td></tr></table></figure><h5 id="日期正则表达式"><a class="markdownIt-Anchor" href="#日期正则表达式"></a> 日期：正则表达式</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">check_datetime</span><span class="params">(value)</span>:</span></span><br><span class="line">    datatime_pattern = <span class="string">r'((((19|20)\d&#123;2&#125;)[-/](0?(1|[3-9])|1[012])[-/](0?[1-9]|[12]\d|30))|(((19|20)\d&#123;2&#125;)[-/](0?[13578]|1[02])[-/]31)|'</span> \</span><br><span class="line">                       <span class="string">r'(((19|20)\d&#123;2&#125;)[-/]0?2[-/](0?[1-9]|1\d|2[0-8]))|((((19|20)([13579][26]|[2468][048]|0[48]))|(2000))[-/]0?2[-/]29))'</span> \</span><br><span class="line">                       <span class="string">r'\s([0-1][0-9]|2[0-3]):([0-5][0-9]):([0-5][0-9])$'</span></span><br><span class="line">    <span class="keyword">if</span> re.match(datatime_pattern, value):</span><br><span class="line">        print(<span class="string">'%s'</span> % s2)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print(<span class="string">'%s'</span> % s1)</span><br></pre></td></tr></table></figure><h5 id="车辆识别代码正则表达式"><a class="markdownIt-Anchor" href="#车辆识别代码正则表达式"></a> 车辆识别代码：正则表达式</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">check_vin</span><span class="params">(value)</span>:</span></span><br><span class="line">    vin_pattern = <span class="string">r'^[A-HJ-NPR-Z\\d]&#123;8&#125;[\dX][A-HJ-NPR-Z\d]&#123;2&#125;\d&#123;6&#125;$'</span></span><br><span class="line">    <span class="keyword">if</span> re.match(vin_pattern,value):</span><br><span class="line">        print(<span class="string">'%s'</span> % s3)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print(<span class="string">'%s'</span> % s1)</span><br></pre></td></tr></table></figure><h5 id="组织机构代码算法"><a class="markdownIt-Anchor" href="#组织机构代码算法"></a> 组织机构代码：算法</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">check_organization</span><span class="params">(value)</span>:</span></span><br><span class="line">    organization_str = value.upper().replace(<span class="string">'-'</span>, <span class="string">''</span>)</span><br><span class="line">    organization_pattern = <span class="string">r'^[\dA-Z]&#123;8&#125;[X\d]$'</span></span><br><span class="line">    <span class="keyword">if</span> re.search(organization_pattern, organization_str, re.S):</span><br><span class="line">        verify_code = [<span class="number">3</span>, <span class="number">7</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">5</span>, <span class="number">8</span>, <span class="number">4</span>, <span class="number">2</span>]</span><br><span class="line">        verify_code = <span class="number">11</span> - sum([int(</span><br><span class="line">            (ord(organization_str[index]) - <span class="number">55</span>) <span class="keyword">if</span> organization_str[index].isalpha() <span class="keyword">else</span> organization_str[index]</span><br><span class="line">        ) * verify_code[index] <span class="keyword">for</span> index <span class="keyword">in</span> range(<span class="number">8</span>)]) % <span class="number">11</span></span><br><span class="line">        verify_code = <span class="string">'X'</span> <span class="keyword">if</span> verify_code == <span class="number">10</span> <span class="keyword">else</span> (<span class="string">'0'</span> <span class="keyword">if</span> verify_code == <span class="number">11</span> <span class="keyword">else</span> str(verify_code))</span><br><span class="line">        <span class="keyword">if</span> verify_code == organization_str[<span class="number">-1</span>]:</span><br><span class="line">            print(<span class="string">'%s'</span> % s3)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            print(<span class="string">'%s'</span> % s1)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print(<span class="string">'%s'</span> % s1)</span><br></pre></td></tr></table></figure><h5 id="营业执照号码-算法"><a class="markdownIt-Anchor" href="#营业执照号码-算法"></a> 营业执照号码 ：算法</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">check_business</span><span class="params">(value)</span>:</span></span><br><span class="line">    business_pattern = <span class="string">r'^\d&#123;15&#125;$'</span></span><br><span class="line">    <span class="keyword">if</span> re.search(business_pattern, value, re.S):</span><br><span class="line">        verify_code = <span class="number">10</span></span><br><span class="line">        <span class="keyword">for</span> index <span class="keyword">in</span> range(<span class="number">14</span>):</span><br><span class="line">            verify_code = (((verify_code % <span class="number">11</span> + int(value[index])) % <span class="number">10</span> <span class="keyword">or</span> <span class="number">10</span>) * <span class="number">2</span>) % <span class="number">11</span></span><br><span class="line">        verify_code = (<span class="number">11</span> - (verify_code % <span class="number">10</span>)) % <span class="number">10</span></span><br><span class="line">        <span class="keyword">if</span> str(verify_code) == value[<span class="number">-1</span>]:</span><br><span class="line">            print(<span class="string">'%s'</span> % s3)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            print(<span class="string">'%s'</span> % s1)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print(<span class="string">'%s'</span> % s1)</span><br></pre></td></tr></table></figure><h5 id="统一社会信用代码算法"><a class="markdownIt-Anchor" href="#统一社会信用代码算法"></a> 统一社会信用代码：算法</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">check_credit</span><span class="params">(value)</span>:</span></span><br><span class="line">    credit_str = value.upper()</span><br><span class="line">    credit_pattern = <span class="string">r'^(1[129]|5[1239]|9[123]|Y1)\d&#123;6&#125;[\dA-Z]&#123;8&#125;[X\d][\dA-Z]$'</span></span><br><span class="line">    <span class="keyword">if</span> len(credit_str) != <span class="number">18</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    search = re.search(credit_pattern, credit_str, re.S)</span><br><span class="line">    <span class="keyword">if</span> search:</span><br><span class="line">        <span class="comment"># if check_organization(xinyong_str[8:17]):</span></span><br><span class="line">            str_to_num = &#123;</span><br><span class="line">                <span class="string">'A'</span>: <span class="number">10</span>, <span class="string">'B'</span>: <span class="number">11</span>, <span class="string">'C'</span>: <span class="number">12</span>, <span class="string">'D'</span>: <span class="number">13</span>, <span class="string">'E'</span>: <span class="number">14</span>, <span class="string">'F'</span>: <span class="number">15</span>, <span class="string">'G'</span>: <span class="number">16</span>, <span class="string">'H'</span>: <span class="number">17</span>, <span class="string">'J'</span>: <span class="number">18</span>, <span class="string">'K'</span>: <span class="number">19</span>,</span><br><span class="line">                <span class="string">'L'</span>: <span class="number">20</span>, <span class="string">'M'</span>: <span class="number">21</span>, <span class="string">'N'</span>: <span class="number">22</span>, <span class="string">'P'</span>: <span class="number">23</span>, <span class="string">'Q'</span>: <span class="number">24</span>, <span class="string">'R'</span>: <span class="number">25</span>, <span class="string">'T'</span>: <span class="number">26</span>, <span class="string">'U'</span>: <span class="number">27</span>, <span class="string">'W'</span>: <span class="number">28</span>, <span class="string">'X'</span>: <span class="number">29</span>, <span class="string">'Y'</span>: <span class="number">30</span>&#125;</span><br><span class="line">            num_to_str = &#123;</span><br><span class="line">                <span class="number">10</span>: <span class="string">'A'</span>, <span class="number">11</span>: <span class="string">'B'</span>, <span class="number">12</span>: <span class="string">'C'</span>, <span class="number">13</span>: <span class="string">'D'</span>, <span class="number">14</span>: <span class="string">'E'</span>, <span class="number">15</span>: <span class="string">'F'</span>, <span class="number">16</span>: <span class="string">'G'</span>, <span class="number">17</span>: <span class="string">'H'</span>, <span class="number">18</span>: <span class="string">'J'</span>, <span class="number">19</span>: <span class="string">'K'</span>,</span><br><span class="line">                <span class="number">20</span>: <span class="string">'L'</span>, <span class="number">21</span>: <span class="string">'M'</span>, <span class="number">22</span>: <span class="string">'N'</span>, <span class="number">23</span>: <span class="string">'P'</span>, <span class="number">24</span>: <span class="string">'Q'</span>, <span class="number">25</span>: <span class="string">'R'</span>, <span class="number">26</span>: <span class="string">'T'</span>, <span class="number">27</span>: <span class="string">'U'</span>, <span class="number">28</span>: <span class="string">'W'</span>, <span class="number">29</span>: <span class="string">'X'</span>, <span class="number">30</span>: <span class="string">'Y'</span>&#125;</span><br><span class="line">            verify_code = [<span class="number">1</span>, <span class="number">3</span>, <span class="number">9</span>, <span class="number">27</span>, <span class="number">19</span>, <span class="number">26</span>, <span class="number">16</span>, <span class="number">17</span>, <span class="number">20</span>, <span class="number">29</span>, <span class="number">25</span>, <span class="number">13</span>, <span class="number">8</span>, <span class="number">24</span>, <span class="number">10</span>, <span class="number">30</span>, <span class="number">28</span>]</span><br><span class="line">            verify_code = <span class="number">31</span> - sum([(str_to_num.get(credit_str[index], <span class="number">0</span>) <span class="keyword">if</span> credit_str[index].isalpha() <span class="keyword">else</span> int(credit_str[index])</span><br><span class="line">                                     ) * verify_code[index] <span class="keyword">for</span> index <span class="keyword">in</span> range(<span class="number">17</span>)]) % <span class="number">31</span></span><br><span class="line">            verify_code = num_to_str.get(verify_code, <span class="string">''</span>) <span class="keyword">if</span> verify_code &gt; <span class="number">9</span> <span class="keyword">else</span> verify_code</span><br><span class="line">            <span class="keyword">if</span> verify_code == credit_str[<span class="number">-1</span>]:</span><br><span class="line">                print(<span class="string">'%s'</span> % s3)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                print(<span class="string">'%s'</span> % s1)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print(<span class="string">'%s'</span> % s1)</span><br></pre></td></tr></table></figure></div><div class="article-footer"><blockquote class="mt-2x"><ul class="post-copyright list-unstyled"><li class="post-copyright-link hidden-xs"><strong>本文链接：</strong> <a href="https://www.browsersytle.cn/2019/11/13/敏感数据识别和分级打标.html" title="敏感数据识别和分级打标" target="_blank" rel="external">https://www.browsersytle.cn/2019/11/13/敏感数据识别和分级打标.html</a></li><li class="post-copyright-license"><strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="http://creativecommons.org/licenses/by/4.0/deed.zh" target="_blank" rel="external">CC BY 4.0 CN协议</a> 许可协议。转载请注明出处！</li></ul></blockquote><div class="panel panel-default panel-badger"><div class="panel-body"><figure class="media"><div class="media-left"><a href="https://github.com/xiaoyunjie" target="_blank" class="img-burn thumb-sm visible-lg"><img src="/blog/images/personal.png" class="img-rounded w-full" alt></a></div><div class="media-body"><h3 class="media-heading"><a href="https://github.com/xiaoyunjie" target="_blank"><span class="text-dark">猪蹄胖(Browser)</span><small class="ml-1x">Operations and development</small></a></h3><div>网络领域中的开发萌新，开发领域中的运维菜鸟，运维领域中的安全小哥，安全领域中的网络愣头青。热爱生活,fighting!!!</div></div></figure></div></div></div></article><section id="comments"><div id="vcomments"></div></section></div><nav class="bar bar-footer clearfix" data-stick-bottom><div class="bar-inner"><ul class="pager pull-left"><li class="prev"><a href="/blog/2019/11/13/Linux系统检测和防护脚本.html" title="Linux系统检测和防护脚本"><i class="icon icon-angle-left" aria-hidden="true"></i><span>&nbsp;&nbsp;上一篇</span></a></li><li class="next"><a href="/blog/2019/07/22/SQL基础.html" title="SQL基础"><span>下一篇&nbsp;&nbsp;</span><i class="icon icon-angle-right" aria-hidden="true"></i></a></li><li class="toggle-toc"><a class="toggle-btn collapsed" data-toggle="collapse" href="#collapseToc" aria-expanded="false" title="文章目录" role="button"><span>[&nbsp;</span><span>文章目录</span> <i class="text-collapsed icon icon-anchor"></i> <i class="text-in icon icon-close"></i> <span>]</span></a></li></ul><button type="button" class="btn btn-fancy btn-donate pop-onhover bg-gradient-warning" data-toggle="modal" data-target="#donateModal"><span>赏</span></button><div class="bar-right"><div class="share-component" data-sites="weibo,qq,wechat,facebook,twitter" data-mobile-sites="weibo,qq,qzone"></div></div></div></nav><div class="modal modal-center modal-small modal-xs-full fade" id="donateModal" tabindex="-1" role="dialog"><div class="modal-dialog" role="document"><div class="modal-content donate"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><div class="modal-body"><div class="donate-box"><div class="donate-head"><p>感谢您的支持，我会继续努力的!</p></div><div class="tab-content"><div role="tabpanel" class="tab-pane fade active in" id="alipay"><div class="donate-payimg"><img src="/blog/images/donate/alipayimg.png" alt="扫码支持" title="扫一扫"></div><p class="text-muted mv">扫码打赏，你说多少就多少</p><p class="text-grey">打开支付宝扫一扫，即可进行扫码打赏哦</p></div><div role="tabpanel" class="tab-pane fade" id="wechatpay"><div class="donate-payimg"><img src="/blog/images/donate/wechatpayimg.png" alt="扫码支持" title="扫一扫"></div><p class="text-muted mv">扫码打赏，你说多少就多少</p><p class="text-grey">打开微信扫一扫，即可进行扫码打赏哦</p></div></div><div class="donate-footer"><ul class="nav nav-tabs nav-justified" role="tablist"><li role="presentation" class="active"><a href="#alipay" id="alipay-tab" role="tab" data-toggle="tab" aria-controls="alipay" aria-expanded="true"><i class="icon icon-alipay"></i> 支付宝</a></li><li role="presentation"><a href="#wechatpay" role="tab" id="wechatpay-tab" data-toggle="tab" aria-controls="wechatpay" aria-expanded="false"><i class="icon icon-wepay"></i> 微信支付</a></li></ul></div></div></div></div></div></div></main><footer class="footer" itemscope itemtype="http://schema.org/WPFooter"><ul class="social-links"><li><a href="https://github.com/xiaoyunjie" target="_blank" title="Github" data-toggle="tooltip" data-placement="top"><i class="icon icon-github"></i></a></li><li><a href="http://weibo.com/nupthot" target="_blank" title="Weibo" data-toggle="tooltip" data-placement="top"><i class="icon icon-weibo"></i></a></li><li><a href="/blog/atom.xml" target="_blank" title="Rss" data-toggle="tooltip" data-placement="top"><i class="icon icon-rss"></i></a></li></ul><div class="copyright"><div class="publishby"><a>Where there is a will there is a way</a> <a href="http://www.beian.miit.gov.cn/">苏ICP备19028216号</a></div></div></footer><script src="//cdn.jsdelivr.net/npm/jquery@1.12.4/dist/jquery.min.js"></script><script>window.jQuery||document.write('<script src="js/jquery.min.js"><\/script>')</script><script src="/blog/js/plugin.min.js"></script><script src="/blog/js/application.js"></script><script>!function(T){var N={TRANSLATION:{POSTS:"文章",PAGES:"页面",CATEGORIES:"分类",TAGS:"标签",UNTITLED:"(未命名)"},ROOT_URL:"/blog/",CONTENT_URL:"/blog/content.json"};T.INSIGHT_CONFIG=N}(window)</script><script src="/blog/js/insight.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//cdn.jsdelivr.net/npm/valine"></script><script type="text/javascript">var GUEST=["nick","mail","link"],meta="nick,mail,link";meta=meta.split(",").filter(function(e){return GUEST.indexOf(e)>-1}),new Valine({el:"#vcomments",verify:!0,notify:!0,appId:"Ox78uODkQ6KRzC9yeLPh9CBu-gzGzoHsz",appKey:"zWeYG4xFd6UstqcOY0MObyqE",placeholder:"ヾﾉ≧∀≦)o来啊，快活啊!",avatar:"monsterid",meta:meta,pageSize:"10",visitor:!0})</script><script src="//cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.3.5/dist/jquery.fancybox.min.js"></script><script>$(document).ready(function(){$("article img").not("[hidden]").not(".panel-body img").each(function(){var a=$(this),t=a.attr("alt"),n=a.parent("a");if(n.length<1){var e=this.getAttribute("src"),r=e.lastIndexOf("?");-1!=r&&(e=e.substring(0,r)),n=a.wrap('<a href="'+e+'"></a>').parent("a")}n.attr("data-fancybox","images"),t&&n.attr("data-caption",t)}),$().fancybox({selector:'[data-fancybox="images"]',hash:!1,loop:!1})})</script><script defer type="text/javascript">!function(e,a,t,n,c,o,s){e.GoogleAnalyticsObject=c,e[c]=e[c]||function(){(e[c].q=e[c].q||[]).push(arguments)},e[c].l=1*new Date,o=a.createElement(t),s=a.getElementsByTagName(t)[0],o.async=1,o.src=n,s.parentNode.insertBefore(o,s)}(window,document,"script","//www.google-analytics.com/analytics.js","ga"),ga("create","141413709","auto"),ga("send","pageview")</script></body></html><!-- rebuild by neat -->