{"meta":{"title":"猪蹄胖的窝","subtitle":null,"description":"孩儿们,造起来","author":"Browser","url":"https://www.browsersytle.cn","root":"/blog/"},"pages":[{"title":"404 Not Found：该页无法显示","date":"2019-06-05T07:14:44.119Z","updated":"2019-06-05T07:14:44.119Z","comments":false,"path":"/404.html","permalink":"https://www.browsersytle.cn//404.html","excerpt":"","text":""},{"title":"关于","date":"2019-06-05T07:19:14.487Z","updated":"2019-06-05T07:19:14.484Z","comments":true,"path":"about/index.html","permalink":"https://www.browsersytle.cn/about/index.html","excerpt":"","text":"个人详细介绍运维开发一枚，平时较忙，放假就想懒懒的躺着不动，所以文章更新较慢。其实平时的积累都有写成文档，只是慵懒的躺着时间久了，发布都不想发布，哈哈"},{"title":"书单","date":"2019-06-04T06:55:20.407Z","updated":"2019-06-04T06:55:20.407Z","comments":false,"path":"books/index.html","permalink":"https://www.browsersytle.cn/books/index.html","excerpt":"","text":""},{"title":"分类","date":"2019-06-05T07:14:27.727Z","updated":"2019-06-05T07:14:27.727Z","comments":false,"path":"categories/index.html","permalink":"https://www.browsersytle.cn/categories/index.html","excerpt":"","text":""},{"title":"友情链接","date":"2019-06-05T07:14:10.824Z","updated":"2019-06-05T07:14:10.824Z","comments":true,"path":"links/index.html","permalink":"https://www.browsersytle.cn/links/index.html","excerpt":"","text":""},{"title":"Repositories","date":"2019-06-04T06:55:20.407Z","updated":"2019-06-04T06:55:20.407Z","comments":false,"path":"repository/index.html","permalink":"https://www.browsersytle.cn/repository/index.html","excerpt":"","text":""},{"title":"标签","date":"2019-06-05T07:25:15.405Z","updated":"2019-06-05T07:25:15.405Z","comments":false,"path":"tags/index.html","permalink":"https://www.browsersytle.cn/tags/index.html","excerpt":"","text":""}],"posts":[{"title":"Nginx限制并发连接数和带宽","slug":"Nginx限制并发连接数和带宽","date":"2019-06-19T14:41:16.000Z","updated":"2019-06-19T15:06:10.741Z","comments":true,"path":"2019/06/19/Nginx限制并发连接数和带宽.html","link":"","permalink":"https://www.browsersytle.cn/2019/06/19/Nginx限制并发连接数和带宽.html","excerpt":"","text":"TCP连接对于一些服务器流量异常、负载过大，甚至是大流量的恶意攻击访问等，进行并发数的限制（共享内存和并发限制需结合系统定制）limit_conn_zone 设置共享内存区域参数123Syntax: limit_conn_zone key zone=name:size;Default: —Context: httplimit_conn 设置共享内存区域和给定键值的最大允许连接数123Syntax: limit_conn zone number;Default: —Context: http, server, locationlimit_conn_log_level 日志可以调整级别，默认error12345Syntax: limit_conn_log_level info | notice | warn | error;Default: limit_conn_log_level error;Context: http, server, location#This directive appeared in version 0.8.18.limit_conn_status 返回状态码响应拒绝请求，默认50312345Syntax: limit_conn_status code;Default: limit_conn_status 503;Context: http, server, location#This directive appeared in version 1.3.15.示例12345678910http &#123;limit_conn_zone $binary_remote_addr zone=perip:10m;limit_conn_zone $server_name zone=perserver_tcp:10m;server &#123; location /download/ &#123; limit_conn perserver_tcp 100;#虚拟服务同时只允许100个连接 limit_conn perip 10;#每个IP同时只允许10个连接 &#125; &#125;&#125;如果共享内存空间10m被耗尽，服务器将会对后续所有的请求返回503 (Service Temporarily Unavailable)错误将限制每个客户机IP到服务器的连接数量，同时限制到虚拟服务器的连接总数: HTTP连接限制来自单个IP地址的请求处理频率，每秒固定处理请求数，推迟过多请求。以此来防止应用层的DDOS攻击（共享内存和请求频率需结合系统定制）limit_req_zone 设置共享内存区域参数123Syntax: limit_req_zone key zone=name:size rate=rate;Default: —Context: httplimit_req 设置共享内存区域、突发大小、延时123Syntax: limit_req zone=name [burst=number] [nodelay];Default: —Context: http, server, locationlimit_req_log_level 日志可以调整级别，默认error12345Syntax: limit_req_log_level info | notice | warn | error;Default: limit_req_log_level error;Context: http, server, location#This directive appeared in version 0.8.18.limit_req_status 返回状态码响应拒绝请求，默认50312345Syntax: limit_req_status code;Default: limit_req_status 503;Context: http, server, location#This directive appeared in version 1.3.15.示例1234567891011http &#123;limit_req_zone $binary_remote_addr zone=ten:20m rate=100r/s;limit_req_zone $server_name zone=perserver_http:20m rate=1000r/s;server &#123; location /search/ &#123; limit_req zone=ten burst=500 nodelay; #每秒100个请求，突发不超过500个请求，降低延时请求 limit_req zone=perserver_http burst=1500; #虚拟服务同时每秒1000个请求，突发不超过1500 &#125; &#125;&#125;如果不希望在请求受到限制时延迟过多的请求，加入参数nodelay当且仅当当前级别上没有limit_req指令时，这些指令才从上一级别继承同时可以有几个limit_req指令 带宽限制limit_rate限制对客户机的响应传输速率1234Syntax: limit_rate rate;Default: limit_rate 0;Context: http, server, location, if in location限制对客户机的响应传输速率。速率以字节/秒为单位指定。零值禁止速率限制。此限制是针对每个请求设置的，因此如果客户端同时打开两个连接，总体速率将是指定限制的两倍。示例123456server &#123; if ($slow) &#123; set $limit_rate 4k; &#125; ...&#125;速率限制也可以在$limit_rate变量中设置limit_rate_after设置初始值，在此之后，对客户机响应的进一步传输将受到速率限制。12345Syntax: limit_rate_after size;Default: limit_rate_after 0;Context: http, server, location, if in locationThis directive appeared in version 0.8.0.示例12345location /flv/ &#123; flv; limit_rate_after 500k; limit_rate 50k;&#125; 参考值Nginx服务器上查看ESTABLISHED的连接数，根据这个连接数来限制tcp连接，上浮10%1Shell&gt;netstat -n | awk '/^tcp/ &#123;++S[$NF]&#125; END &#123;for(a in S) print a, S[a]&#125;'Web浏览器查看nginx服务器的epoint_base_status查看Req/s，根据这个值进行请求数的限制，上浮10%","categories":[{"name":"Nginx","slug":"Nginx","permalink":"https://www.browsersytle.cn/categories/Nginx/"}],"tags":[{"name":"limit","slug":"limit","permalink":"https://www.browsersytle.cn/tags/limit/"}]},{"title":"browser","slug":"browser","date":"2019-05-20T13:58:47.000Z","updated":"2019-06-05T08:30:03.274Z","comments":true,"path":"2019/05/20/browser.html","link":"","permalink":"https://www.browsersytle.cn/2019/05/20/browser.html","excerpt":"","text":"FLASK 安装flask123456789101112131415# 安装pipyum install python-pip# 安装pipenvpip install pipenv# 创建虚拟环境mkdir helloflask &amp;&amp; cd helloflaskpipenv install# 激活虚拟环境,从当前目录的.env读取环境变量pipenv shell/run# 查看当前环境依赖情况pipenv graph# 安装flaskpipenv install flask# 更新flaskpipenv update flaskPipfile: 记录项目依赖包列表Pipfile.lock: 记录了固定版本的详细依赖包列表 环境变量环境变量优先级： 手动设置》.evn设置》.flaskenv设置手动设置环境变量1234# linuxexport FLASK_APP=hello# windowsset FLASK_APP=hello安装python-dotenv12345pipenv isntall python-dotenv# 创建.env，存储包含敏感信息的环境变量touch .env# 创建 .flaskenv，存储flask相关的公开环境变量touch .flaskenv环境变量中是以键值对的形式的定义每行一个#开头为注释设置.flaskenv1234# 设置开发环境FLASK_ENV=development# 设置appFLASK_APP=hello","categories":[{"name":"python","slug":"python","permalink":"https://www.browsersytle.cn/categories/python/"}],"tags":[{"name":"flask","slug":"flask","permalink":"https://www.browsersytle.cn/tags/flask/"}]}]}